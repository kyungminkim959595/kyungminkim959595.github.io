---
layout: distill
title: How Does Classifier-free Guidance Amplify the Societal Bias in Text-to-image Diffusion Models?
description: Literature review and empirical analyses on the bias amplification in CFG for diffusion models
tags: CFG diffusion_model bias
giscus_comments: false
date: 2025-05-27
featured: true
mermaid:
  enabled: true
  zoomable: true
code_diff: true
map: true
chart:
  chartjs: true
  echarts: true
  vega_lite: true
tikzjax: true
typograms: true

authors:
  - name: Myeongsoo Kim
    url: "https://ime.postech.ac.kr/"
    affiliations:
      name: Industrial Management and Engineering, POSTECH
  - name: Kyungmin Kim
    url: "https://ai.postech.ac.kr/"
    affiliations:
      name: Graduate School of Artificial Intelligence, POSTECH
  # - name: Nathan Rosen
  #   url: "https://en.wikipedia.org/wiki/Nathan_Rosen"
  #   affiliations:
  #     name: IAS, Princeton

bibliography: 2025-05-27-cfg-bias.bib

# Optionally, you can add a table of contents to your post.
# NOTES:
#   - make sure that TOC names match the actual section names
#     for hyperlinks within the post to work correctly.
#   - we may want to automate TOC generation in the future using
#     jekyll-toc plugin (https://github.com/toshimaru/jekyll-toc).
toc:
  - name: Group Fairness and Bias Amplification in Generative Models
    # if a section has subsections, you can add them as follows:
    subsections:
      - name: Group Fairness in Generative Models
      - name: Bias Amplification in Generative Models
      - name: Demographic Bias in Text-to-image Diffusion Models
      - name: Bias Evaluation in Text-to-image Diffusion Models
  - name: Bias Ampliification in Classifier-free Guidance for Diffusion Models

# Below is an example of injecting additional post-specific styles.
# If you use this post as a template, delete this _styles block.
_styles: >
  .fake-img {
    background: #bbb;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 0px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 12px;
  }
  .fake-img p {
    font-family: monospace;
    color: white;
    text-align: left;
    margin: 12px 0;
    text-align: center;
    font-size: 16px;
  }
---
## Introduction

### Motivation

Text-to-image (T2I) diffusion models have remarkable capabilities in generating realistic images from input text. (Naik & Nushi, 2023) However, there are growing concerns about their tendency to produce biased images toward specific demographic groups ex) gender bias, skin tone bias, attribute bias, …. Because large-scale datasets encode these social biases and diffusion models learn from that distribution, they tend to generate biased images toward specific demographic groups. We address the bias amplification phenomenon such that a model’s outputs exhibit stronger biases than those present in its training data like figure 1.

<div class="row justify-content-sm-center">
  <div class="col-sm-10 mt-3 mt-md-0">
    {% include figure.liquid
       path="assets/img/cfg_ba/ba_figure.jpg"
       title="Figure 1. The Bias Amplification Paradox in Text-to-Image Generation"
       class="img-fluid rounded z-depth-1" %}
  </div>
</div>

Which factors drive bias amplification in T2I diffusion models? We pinpoint Classifier-Free Guidance (CFG)—universally applied during T2I diffusion model generation—as a potential contributor. While CFG substantially improves image fidelity and alignment with the conditioning prompt, elevating its strength inherently diminishes sample diversity and biases generation toward prototypical outputs. In practice, users typically operate in the higher guidance‐scale range, adjusting the parameter to obtain their desired images.

Recently, Kim et al. (2024) empirically demonstrated that higher CFG scales correspond to an increased prevalence of majority-group attributes, thereby identifying CFG intensity as a direct mechanism of bias amplification.

figure 2

In this blog post, we analyze how Classifier‐Free Guidance (CFG) drives bias amplification in text‐to‐image diffusion models. Our work proceeds in three steps: (1) we formulate the problem by surveying prior research on CFG’s impact on model distributions; (2) we quantitatively assess the degree to which CFG contributes to bias amplification; and (3) we characterize the relationship between guidance scale and bias trends. We conducted our experimental analysis on the gender–occupation bias, a primary focus in fairness studies of text-to-image generative models.

Based on these findings, we argue that—unlike mainstream efforts aimed at enforcing fairness in the conditional distribution p(x|y) —future research must target fairness in the reverse conditional p(y|x), particularly under low‐temperature sampling regimes.


## Preliminary

### Group Fairness and Bias amplification

### Diffusion Model and Classifier-free guidance

Recent diffusion models belong to the family of score-based generative models and are formulated within the stochastic differential equation (SDE) framework.

figure 3

The forward process refers to perturbing the data distribution via a diffusion process. As indicated by the symmetric coloring of the density-representing boxes in the figure, the reverse process reconstructs the marginal distributions of the forward process at each time step. To generate images, one must solve the reverse SDE, which therefore requires an accurate estimate of the score function.

Classifier-free guidance(CFG) is a sampling strategy that employs an extrapolated score toward the conditional distribution, controlled by the guidance scale w, as follows. It pushes samples in the direction of higher p(c \mid x), but it does not directly correspond to the distribution p_w.

p

Here, it is important to note that the sampling distribution has deviated from the original data distribution. Bias amplification refers to the phenomenon in which a diffusion model’s sample distribution—expected in theory to follow the data distribution—actually exhibits an exacerbated bias. By applying CFG, however, the intended sampling distribution is inherently shifted from the pure data distribution to one weighted by both p(y∣x) and the guidance scale w.

Furthermore, we demonstrated in a simple setup (see Figure 4) that this shift acts to amplify bias in gender-occupation fairness. While the unconditional distribution corresponds to a single marginal distribution, the conditional distribution can exhibit higher or lower densities for specific groups depending on the conditioning variable y.

figure 3

In the Experiments section, we empirically demonstrate that this tendency can indeed be observed in both text-to-image diffusion models and a toy example.

---

## Experiment

### T2I diffusion model : Stable diffusion

### Class conditional diffusion model

---

## Discussion

In this blog post, we empirically assessed the impact of CFG on bias amplification in T2I diffusion models, demonstrating that CFG amplifies bias by extrapolating 

the conditional distribution further away from the unconditional distribution.

The limitations not addressed in this post are as follows:

- The numerical values cannot be considered strictly precise because our evaluation operates on high-dimensional, complex text-conditioned distributions.
- Images generated at low guidance scales often fail to form properly, making those measurements less reliable. Since we assigned gender by mapping each image to the closest class using a CLIP classifier, the CLIP model’s own biases may have influenced our results.

To address these, we validated the observed trends using toy examples.

Through this blog post, we emphasize that group-fairness research for diffusion models must address the effects of CFG, and more broadly, that debiasing low-temperature sampling strategies is essential for generative models. 

- In most of the papers I reviewed, there is little to no discussion of CFG’s impact, and their experimental setups are often missed.
- Kim et al. (2024), who previously identified the same problem, proposed a solution that attenuates bias in the text-condition embeddings of the text-conditional component.  We approached the problem from a slightly different angle, framing it as the disparity in bias levels for the attribute between the conditional distribution and the unconditional distribution.
- Our proposal is to reduce this disparity, and we believe that one promising direction is to leverage Autoguidance—one of the recent state-of-the-art CFG methods. This methodology leverages the conditional distribution of a weaker model rather than the unconditional distribution. However, it still does not resolve which weaker model should be employed within T2I diffusion frameworks, necessitating further research.

We have always considered fairness only with respect to $p(x \mid y)$, but for practical applications, fairness in $p(y \mid x)$ must also be taken into account.

---